SET SQLPROMPT "";
SET SQLNUMBER OFF;


CONNECT SYSTEM/SYSTEM;

DROP USER P33 CASCADE;
CREATE USER P33 IDENTIFIED BY "P33";
GRANT CONNECT,RESOURCE TO P33;


CONNECT P33/P33;

CREATE TABLE EMPRESAS
(
  CIF       CHAR(9),
  NOMBRE    VARCHAR2(50),
  DIRECCION VARCHAR2(50),
  TELEFONO  CHAR(9),
  CONSTRAINT PK_EMPRESA PRIMARY KEY(CIF)
);


CREATE TABLE ALUMNOS
(
  DNI        CHAR(9),
  NOMBRE     VARCHAR2(50),
  APELLIDO1  VARCHAR2(50),
  APELLIDO2  VARCHAR2(50),
  TELEFONO   CHAR(9),
  EDAD       NUMBER,
  CIF        CHAR(9),
  CONSTRAINT PK_ALUMNOS PRIMARY KEY(DNI),
  CONSTRAINT FK_ALUMNOS FOREIGN KEY(CIF) REFERENCES EMPRESAS
);


CREATE TABLE PROFESORES
(
  DNI_PROF   CHAR(9),
  NOMBRE     VARCHAR2(50),
  APELLIDO1  VARCHAR2(50),
  APELLIDO2  VARCHAR2(50),
  DIRECCION  VARCHAR2(50),
  TELEFONO   CHAR(9),
  CONSTRAINT PK_PROFESORES PRIMARY KEY(DNI_PROF)
);


CREATE TABLE TIPOS_CURSO
(
  COD_TIPO_CURSO NUMBER(2),
  TITULO         VARCHAR2(50),
  DURACION       NUMBER,
  CONSTRAINT PK_TIPOS_CURSO PRIMARY KEY(COD_TIPO_CURSO)
);


CREATE TABLE CURSOS
(
  N_CURSO         NUMBER(3),
  FECHA_INICIO    DATE,
  FECHA_FIN       DATE,
  DNI_PROF        CHAR(9),
  COD_TIPO_CURSO  NUMBER(2),
  CONSTRAINT PK_CURSOS  PRIMARY KEY (N_CURSO),
  CONSTRAINT FK1_CURSOS FOREIGN KEY (DNI_PROF) REFERENCES PROFESORES,
  CONSTRAINT FK2_CURSOS FOREIGN KEY (COD_TIPO_CURSO) 
     REFERENCES TIPOS_CURSO
);


CREATE TABLE ASISTIR
(
  N_CURSO     NUMBER(3),
  DNI_ALUMNO  CHAR(9),
  NOTA        NUMBER,
  CONSTRAINT PK_ASISTIR  PRIMARY KEY (N_CURSO,DNI_ALUMNO),
  CONSTRAINT FK1_ASISTIR FOREIGN KEY (N_CURSO) REFERENCES CURSOS,
  CONSTRAINT FK2_ASISTIR FOREIGN KEY (DNI_ALUMNO) REFERENCES ALUMNOS
);

