SET SQLPROMPT "";
SET SQLNUMBER OFF;


CONNECT SYSTEM/SYSTEM;

DROP USER E10 CASCADE;
CREATE USER E10 IDENTIFIED BY "E10";
GRANT CONNECT,RESOURCE TO E10;


CONNECT E10/E10;

CREATE TABLE FABRICA
(
  NUMFABRICA NUMBER(2),
  TELEFONO   CHAR(9)
);

ALTER TABLE FABRICA ADD CONSTRAINT PK_FABRICA 
  PRIMARY KEY(NUMFABRICA);


CREATE TABLE ARTICULO
(
  NUMARTICULO NUMBER(5),
  DESCRIPCION VARCHAR2(100)
);

ALTER TABLE ARTICULO ADD CONSTRAINT PK_ARTICULO 
  PRIMARY KEY(NUMARTICULO);



CREATE TABLE CLIENTE
(
  NUMCLIENTE NUMBER(5),
  SALDO      NUMBER,
  LIMCREDITO NUMBER(4),
  DESCUENTO  NUMBER(2)
);

ALTER TABLE CLIENTE ADD CONSTRAINT PK_CLIENTE 
  PRIMARY KEY(NUMCLIENTE);


CREATE TABLE DIRECCION
(
  CODDIRECCION  CHAR(8),
  VIA           VARCHAR2(20),
  NOMBREVIA     VARCHAR2(50),
  NUMERO        NUMBER(3),
  PISO          NUMBER(1),
  PORTAL        CHAR(1),
  CODPOSTAL     CHAR(5)
);

ALTER TABLE DIRECCION ADD CONSTRAINT PK_DIRECCION
  PRIMARY KEY (CODDIRECCION);


CREATE TABLE PEDIDO
(
  NUMPEDIDO    NUMBER(5),
  FECHA        DATE,
  NUMCLIENTE   NUMBER(5),
  CODDIRECCION CHAR(8)
);

ALTER TABLE PEDIDO ADD CONSTRAINT PK_PEDIDO
  PRIMARY KEY (NUMPEDIDO);

ALTER TABLE PEDIDO ADD CONSTRAINT FK1_PEDIDO
  FOREIGN KEY (NUMCLIENTE) REFERENCES CLIENTE(NUMCLIENTE);

ALTER TABLE PEDIDO ADD CONSTRAINT FK2_PEDIDO
  FOREIGN KEY (CODDIRECCION) REFERENCES DIRECCION(CODDIRECCION);


CREATE SEQUENCE NUMCLIENTE;
CREATE SEQUENCE NUMPEDIDO;
CREATE SEQUENCE NUMARTICULO;
CREATE SEQUENCE NUMFABRICA;


CREATE TABLE POSEE
(
  NUMCLIENTE   NUMBER(5),
  CODDIRECCION CHAR(8)
);

ALTER TABLE POSEE ADD CONSTRAINT PK_POSEE 
  PRIMARY KEY(NUMCLIENTE, CODDIRECCION);

ALTER TABLE POSEE ADD CONSTRAINT FK1_POSEE
  FOREIGN KEY(NUMCLIENTE) REFERENCES CLIENTE(NUMCLIENTE);

ALTER TABLE POSEE ADD CONSTRAINT FK2_POSEE 
  FOREIGN KEY(CODDIRECCION) REFERENCES DIRECCION(CODDIRECCION);


CREATE TABLE INCLUYE
(
  NUMPEDIDO   NUMBER(5),
  NUMARTICULO NUMBER(5),
  CANTIDAD    NUMBER(5)
);

ALTER TABLE INCLUYE ADD CONSTRAINT PK_INCLUYE 
  PRIMARY KEY(NUMPEDIDO,NUMARTICULO);

ALTER TABLE INCLUYE ADD CONSTRAINT FK1_INCLUYE 
  FOREIGN KEY(NUMPEDIDO) REFERENCES PEDIDO(NUMPEDIDO);

ALTER TABLE INCLUYE ADD CONSTRAINT FK2_INCLUYE 
  FOREIGN KEY(NUMARTICULO) REFERENCES ARTICULO(NUMARTICULO);


CREATE TABLE DISTRIBUYE
(
  NUMFABRICA     NUMBER(2),
  NUMARTICULO    NUMBER(5),
  CANTSUMINISTRO NUMBER(5),
  EXISTENCIAS    NUMBER(5)
);

ALTER TABLE DISTRIBUYE ADD CONSTRAINT PK_DISTRIBUYE
  PRIMARY KEY(NUMFABRICA,NUMARTICULO);

ALTER TABLE DISTRIBUYE ADD CONSTRAINT FK1_DISTRIBUYE 
  FOREIGN KEY(NUMFABRICA) REFERENCES FABRICA(NUMFABRICA);

ALTER TABLE DISTRIBUYE ADD CONSTRAINT FK2_DISTRIBUYE
  FOREIGN KEY(NUMARTICULO) REFERENCES ARTICULO(NUMARTICULO);

